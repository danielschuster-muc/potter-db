# REST API

Nossa API RESTful fornece uma maneira simples de interagir com o Potter DB, aderindo às especificações JSON:API e OAS. Nesta seção, cobriremos os aspectos-chave de usar a API REST, incluindo os endpoints disponíveis e como formatar suas solicitações e respostas.

## Endpoints Disponíveis

Para acessar dados da API REST, você precisa fazer uma solicitação `GET` para um dos seguintes endpoints

<details>
<summary>Expandir para ver todos os endpoints</summary>

**Livros**
- `/v1/books`: Recupera uma lista de livros.
- `/v1/books/{id}`: Recupera um único livro pelo seu ID.
- `/v1/books/{book_id}/chapters`: Recupera uma lista de capítulos para um dado livro.
- `/v1/books/{book_id}/chapters/{id}`: Recupera um único capítulo de livro para um dado ID.

**Personagens**
- `/v1/characters`: Recupera uma lista de personagens.
- `/v1/characters/{id}`: Recupera um único personagem pelo seu ID.

**Filmes**
- `/v1/movies`: Recupera uma lista de filmes.
- `/v1/movies/{id}`: Recupera um único filme pelo seu ID.

**Poções**
- `/v1/potions`: Recupera uma lista de poções.
- `/v1/potions/{id}`: Recupera uma única poção pelo seu ID..

**Feitiços**
- `/v1/spells`: Recupera uma lista de feitiços.
- `/v1/spells/{id}`: Recupera um único feitiço pelo seu ID.

IDs devem ser fornecidos como UUIDs ou identificadores.

</details>

## Especificação OpenAPI (OAS)

Para fazer a integração mais facilmente, fornecemos um documento de [Especificação OpenAPI](https://openapis.org) que descreve os endpoints da API, modelos de dados e esquemas de solicitação/resposta.
A API está em conformidade com a versão 3.0.3 da especificação OAS.
Você pode encontrar o documento OAS atual [aqui](https://api.potterdb.com/v1/openapi.json).

## Formato JSON:API

Nossa API REST adere à formatação da [especificação JSON:API](https://jsonapi.org/), que fornece a forma consistente de estruturar solicitações e respostas de API. Aqui está uma visão geral dos principais recursos do JSON:API no contexto da nossa API:

- **Objetos de Recursos**: Cada recurso é representado como um objeto com `type`, `id` e `attributes`.
- **Relacionamentos**: Recursos podem ser relacionados a outros recursos, por exemplo, o recurso `book` é relacionado aos recursos `chapter` e vice versa.
- **Paginação**: Quando uma resposta contém um grande número de recursos, ela será paginada. Veja [Paginação](/pagination) para mais informações.
- **Erros**: Erros são retornados com estruturas padronizadas, facilitando o tratamento e a solução de problemas.

## Fazendo Solicitações

Para fazer uma solicitação à API REST, você precisa fazer uma solicitação `GET` para um de nossos endpoints disponíveis. Aqui está um exemplo básico de como recuperar uma lista de personagens usando o endpoint `/characters`:

```http
GET https://api.potterdb.com/v1/characters
```

Consulte o documento de especificação OpenAPI para obter informações detalhadas.

## Paginação

Respostas com um grande número de recursos serão paginadas. A resposta incluirá um objeto `links` com `first`, `last`, `prev` e `next` ligados a primeira, última, anterior e próxima páginas de resultados, respectivamente.

Para alterar a quantidade de recursos por página, você pode usar o parâmetro `page[size]` da query (tamanho máximo é 100):

```http
GET https://api.potterdb.com/v1/characters?page[size]=25
```

Para alterar a página atual, você pode usar o parâmetro `page[number]` da query:

```http
GET https://api.potterdb.com/v1/characters?page[number]=2
```

## Ransack

Nossa API REST suporta filtragem e classificação avançadas usando [Ransack](https://activerecord-hackery.github.io/ransack/).

### Filtragem

Você pode filtrar recursos adicionando um parâmetro `filter` da query à sua solicitação. Por exemplo, para filtrar personagens por nome, você pode usar o atributo `name_cont`:

```http
GET https://api.potterdb.com/v1/characters?filter[name_cont]=Weasley
```

Isso retornará todos os personagens com o nome "Weasley".

<details>
  <summary>Expandir para ver todos os atributos de filtro disponíveis</summary>
  - `eq`: igual
  - `eq_any`: igual a qualquer um
  - `eq_all`: equals a tudo
  - `not_eq`: não é igual a  
  - `not_eq_any`: não é igual a nenhum 
  - `not_eq_all`: não é igual a todos
  - `matches`: corresponde 
  - `matches_any`: corresponde a qualquer um 
  - `matches_all`: corresponde a todos
  - `does_not_match`: não corresponde
  - `does_not_match_any`: não corresponde a nenhum 
  - `does_not_match_all`: não corresponde a todos
  - `lt`: menor que
  - `lt_any`: menor que qualquer um 
  - `lt_all`: menor que todos
  - `lteq`: menor que ou igual a 
  - `lteq_any`: menor que ou igual a qualquer um 
  - `lteq_all`: menor que ou igual a todos
  - `gt`: maior que
  - `gt_any`: maior que qualquer um 
  - `gt_all`: maior que todos
  - `gteq`: maior que ou igual a
  - `gteq_any`: maior que ou igual a qualquer um  
  - `gteq_all`: maior que ou igual a todos
  - `in`: em
  - `in_any`: em qualquer 
  - `in_all`: em tudo
  - `not_in`: não em
  - `not_in_any`: não em qualquer 
  - `not_in_all`: não em tudo
  - `cont`: contém
  - `cont_any`: contém qualquer um 
  - `cont_all`: contém tudo
  - `not_cont`: não contém 
  - `not_cont_any`: não contém qualquer um
  - `not_cont_all`: não contém tudo
  - `start`: começa com
  - `start_any`: começa com qualquer um
  - `start_all`: começa com tudo
  - `not_start`: não começa com 
  - `not_start_any`: não começa com qualquer um 
  - `not_start_all`: não começa com tudo
  - `end`: termina com
  - `end_any`: termina com qualquer um 
  - `end_all`: termina com tudo
  - `not_end`: não termina com 
  - `not_end_any`: não termina com qualquer um 
  - `not_end_all`: não termina com tudo
  - `'true'`: verdadeiro
  - `'false'`: falso
  - `present`: presente 
  - `blank`: em branco
  - `'null'`: nulo
  - `not_null`: não é nulo
</details>

### Classificação

Você pode ordenar recursos adicionando um parâmetro `sort` da query à sua solicitação. Por exemplo, para ordenar personagens pelo nome, você pode usar o atributo `name` (vá para [Recursos](/resources) para ver todos os atributos disponíveis):

```http
GET https://api.potterdb.com/v1/characters?sort=name
```

Use o prefixo `-` para classificar em ordem decrescente.
